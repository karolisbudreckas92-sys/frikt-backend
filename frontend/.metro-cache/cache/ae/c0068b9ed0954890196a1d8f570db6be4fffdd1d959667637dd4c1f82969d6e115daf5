{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":38,"index":198}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const isAdmin = user?.role === 'admin';\n    (0, _react.useEffect)(() => {\n      loadStoredAuth();\n    }, []);\n    const loadStoredAuth = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('auth_token');\n        const storedUser = await AsyncStorage.default.getItem('auth_user');\n        if (storedToken && storedUser) {\n          setToken(storedToken);\n          setUser(JSON.parse(storedUser));\n          _servicesApi.api.setToken(storedToken);\n\n          // Verify token is still valid\n          try {\n            const response = await _servicesApi.api.getMe();\n            setUser(response);\n            await AsyncStorage.default.setItem('auth_user', JSON.stringify(response));\n          } catch (error) {\n            // Token invalid, clear auth\n            await logout();\n          }\n        }\n      } catch (error) {\n        console.error('Error loading auth:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      const response = await _servicesApi.api.login(email, password);\n      const {\n        access_token,\n        user: userData\n      } = response;\n      await AsyncStorage.default.setItem('auth_token', access_token);\n      await AsyncStorage.default.setItem('auth_user', JSON.stringify(userData));\n      _servicesApi.api.setToken(access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const register = async (name, email, password) => {\n      const response = await _servicesApi.api.register(name, email, password);\n      const {\n        access_token,\n        user: userData\n      } = response;\n      await AsyncStorage.default.setItem('auth_token', access_token);\n      await AsyncStorage.default.setItem('auth_user', JSON.stringify(userData));\n      _servicesApi.api.setToken(access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('auth_token');\n      await AsyncStorage.default.removeItem('auth_user');\n      _servicesApi.api.setToken(null);\n      setToken(null);\n      setUser(null);\n    };\n    const refreshUser = async () => {\n      if (token) {\n        try {\n          const response = await _servicesApi.api.getMe();\n          setUser(response);\n          await AsyncStorage.default.setItem('auth_user', JSON.stringify(response));\n        } catch (error) {\n          console.error('Error refreshing user:', error);\n        }\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        token,\n        isLoading,\n        isAdmin,\n        login,\n        register,\n        logout,\n        refreshUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":123,"map":[[13,2,30,0,"exports"],[13,9,30,0],[13,10,30,0,"AuthProvider"],[13,22,30,0],[13,25,30,0,"AuthProvider"],[13,37,30,0],[14,2,119,0,"exports"],[14,9,119,0],[14,10,119,0,"useAuth"],[14,17,119,0],[14,20,119,0,"useAuth"],[14,27,119,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_servicesApi"],[18,18,3,0],[18,21,3,0,"require"],[18,28,3,0],[18,29,3,0,"_dependencyMap"],[18,43,3,0],[19,2,3,38],[19,6,3,38,"_reactJsxDevRuntime"],[19,25,3,38],[19,28,3,38,"require"],[19,35,3,38],[19,36,3,38,"_dependencyMap"],[19,50,3,38],[20,2,28,0],[20,8,28,6,"AuthContext"],[20,19,28,17],[20,35,28,20],[20,39,28,20,"createContext"],[20,45,28,33],[20,46,28,33,"createContext"],[20,59,28,33],[20,61,28,63,"undefined"],[20,70,28,72],[20,71,28,73],[21,2,30,7],[21,11,30,16,"AuthProvider"],[21,23,30,28,"AuthProvider"],[21,24,30,29],[22,4,30,31,"children"],[23,2,30,65],[23,3,30,66],[23,5,30,68],[24,4,31,2],[24,10,31,8],[24,11,31,9,"user"],[24,15,31,13],[24,17,31,15,"setUser"],[24,24,31,22],[24,25,31,23],[24,28,31,26],[24,32,31,26,"useState"],[24,38,31,34],[24,39,31,34,"useState"],[24,47,31,34],[24,49,31,48],[24,53,31,52],[24,54,31,53],[25,4,32,2],[25,10,32,8],[25,11,32,9,"token"],[25,16,32,14],[25,18,32,16,"setToken"],[25,26,32,24],[25,27,32,25],[25,30,32,28],[25,34,32,28,"useState"],[25,40,32,36],[25,41,32,36,"useState"],[25,49,32,36],[25,51,32,52],[25,55,32,56],[25,56,32,57],[26,4,33,2],[26,10,33,8],[26,11,33,9,"isLoading"],[26,20,33,18],[26,22,33,20,"setIsLoading"],[26,34,33,32],[26,35,33,33],[26,38,33,36],[26,42,33,36,"useState"],[26,48,33,44],[26,49,33,44,"useState"],[26,57,33,44],[26,59,33,45],[26,63,33,49],[26,64,33,50],[27,4,35,2],[27,10,35,8,"isAdmin"],[27,17,35,15],[27,20,35,18,"user"],[27,24,35,22],[27,26,35,24,"role"],[27,30,35,28],[27,35,35,33],[27,42,35,40],[28,4,37,2],[28,8,37,2,"useEffect"],[28,14,37,11],[28,15,37,11,"useEffect"],[28,24,37,11],[28,26,37,12],[28,32,37,18],[29,6,38,4,"loadStoredAuth"],[29,20,38,18],[29,21,38,19],[29,22,38,20],[30,4,39,2],[30,5,39,3],[30,7,39,5],[30,9,39,7],[30,10,39,8],[31,4,41,2],[31,10,41,8,"loadStoredAuth"],[31,24,41,22],[31,27,41,25],[31,33,41,25,"loadStoredAuth"],[31,34,41,25],[31,39,41,37],[32,6,42,4],[32,10,42,8],[33,8,43,6],[33,14,43,12,"storedToken"],[33,25,43,23],[33,28,43,26],[33,34,43,32,"AsyncStorage"],[33,46,43,44],[33,47,43,44,"default"],[33,54,43,44],[33,55,43,45,"getItem"],[33,62,43,52],[33,63,43,53],[33,75,43,65],[33,76,43,66],[34,8,44,6],[34,14,44,12,"storedUser"],[34,24,44,22],[34,27,44,25],[34,33,44,31,"AsyncStorage"],[34,45,44,43],[34,46,44,43,"default"],[34,53,44,43],[34,54,44,44,"getItem"],[34,61,44,51],[34,62,44,52],[34,73,44,63],[34,74,44,64],[35,8,46,6],[35,12,46,10,"storedToken"],[35,23,46,21],[35,27,46,25,"storedUser"],[35,37,46,35],[35,39,46,37],[36,10,47,8,"setToken"],[36,18,47,16],[36,19,47,17,"storedToken"],[36,30,47,28],[36,31,47,29],[37,10,48,8,"setUser"],[37,17,48,15],[37,18,48,16,"JSON"],[37,22,48,20],[37,23,48,21,"parse"],[37,28,48,26],[37,29,48,27,"storedUser"],[37,39,48,37],[37,40,48,38],[37,41,48,39],[38,10,49,8,"api"],[38,22,49,11],[38,23,49,11,"api"],[38,26,49,11],[38,27,49,12,"setToken"],[38,35,49,20],[38,36,49,21,"storedToken"],[38,47,49,32],[38,48,49,33],[40,10,51,8],[41,10,52,8],[41,14,52,12],[42,12,53,10],[42,18,53,16,"response"],[42,26,53,24],[42,29,53,27],[42,35,53,33,"api"],[42,47,53,36],[42,48,53,36,"api"],[42,51,53,36],[42,52,53,37,"getMe"],[42,57,53,42],[42,58,53,43],[42,59,53,44],[43,12,54,10,"setUser"],[43,19,54,17],[43,20,54,18,"response"],[43,28,54,26],[43,29,54,27],[44,12,55,10],[44,18,55,16,"AsyncStorage"],[44,30,55,28],[44,31,55,28,"default"],[44,38,55,28],[44,39,55,29,"setItem"],[44,46,55,36],[44,47,55,37],[44,58,55,48],[44,60,55,50,"JSON"],[44,64,55,54],[44,65,55,55,"stringify"],[44,74,55,64],[44,75,55,65,"response"],[44,83,55,73],[44,84,55,74],[44,85,55,75],[45,10,56,8],[45,11,56,9],[45,12,56,10],[45,19,56,17,"error"],[45,24,56,22],[45,26,56,24],[46,12,57,10],[47,12,58,10],[47,18,58,16,"logout"],[47,24,58,22],[47,25,58,23],[47,26,58,24],[48,10,59,8],[49,8,60,6],[50,6,61,4],[50,7,61,5],[50,8,61,6],[50,15,61,13,"error"],[50,20,61,18],[50,22,61,20],[51,8,62,6,"console"],[51,15,62,13],[51,16,62,14,"error"],[51,21,62,19],[51,22,62,20],[51,43,62,41],[51,45,62,43,"error"],[51,50,62,48],[51,51,62,49],[52,6,63,4],[52,7,63,5],[52,16,63,14],[53,8,64,6,"setIsLoading"],[53,20,64,18],[53,21,64,19],[53,26,64,24],[53,27,64,25],[54,6,65,4],[55,4,66,2],[55,5,66,3],[56,4,68,2],[56,10,68,8,"login"],[56,15,68,13],[56,18,68,16],[56,24,68,16,"login"],[56,25,68,23,"email"],[56,30,68,36],[56,32,68,38,"password"],[56,40,68,54],[56,45,68,59],[57,6,69,4],[57,12,69,10,"response"],[57,20,69,18],[57,23,69,21],[57,29,69,27,"api"],[57,41,69,30],[57,42,69,30,"api"],[57,45,69,30],[57,46,69,31,"login"],[57,51,69,36],[57,52,69,37,"email"],[57,57,69,42],[57,59,69,44,"password"],[57,67,69,52],[57,68,69,53],[58,6,70,4],[58,12,70,10],[59,8,70,12,"access_token"],[59,20,70,24],[60,8,70,26,"user"],[60,12,70,30],[60,14,70,32,"userData"],[61,6,70,41],[61,7,70,42],[61,10,70,45,"response"],[61,18,70,53],[62,6,72,4],[62,12,72,10,"AsyncStorage"],[62,24,72,22],[62,25,72,22,"default"],[62,32,72,22],[62,33,72,23,"setItem"],[62,40,72,30],[62,41,72,31],[62,53,72,43],[62,55,72,45,"access_token"],[62,67,72,57],[62,68,72,58],[63,6,73,4],[63,12,73,10,"AsyncStorage"],[63,24,73,22],[63,25,73,22,"default"],[63,32,73,22],[63,33,73,23,"setItem"],[63,40,73,30],[63,41,73,31],[63,52,73,42],[63,54,73,44,"JSON"],[63,58,73,48],[63,59,73,49,"stringify"],[63,68,73,58],[63,69,73,59,"userData"],[63,77,73,67],[63,78,73,68],[63,79,73,69],[64,6,75,4,"api"],[64,18,75,7],[64,19,75,7,"api"],[64,22,75,7],[64,23,75,8,"setToken"],[64,31,75,16],[64,32,75,17,"access_token"],[64,44,75,29],[64,45,75,30],[65,6,76,4,"setToken"],[65,14,76,12],[65,15,76,13,"access_token"],[65,27,76,25],[65,28,76,26],[66,6,77,4,"setUser"],[66,13,77,11],[66,14,77,12,"userData"],[66,22,77,20],[66,23,77,21],[67,4,78,2],[67,5,78,3],[68,4,80,2],[68,10,80,8,"register"],[68,18,80,16],[68,21,80,19],[68,27,80,19,"register"],[68,28,80,26,"name"],[68,32,80,38],[68,34,80,40,"email"],[68,39,80,53],[68,41,80,55,"password"],[68,49,80,71],[68,54,80,76],[69,6,81,4],[69,12,81,10,"response"],[69,20,81,18],[69,23,81,21],[69,29,81,27,"api"],[69,41,81,30],[69,42,81,30,"api"],[69,45,81,30],[69,46,81,31,"register"],[69,54,81,39],[69,55,81,40,"name"],[69,59,81,44],[69,61,81,46,"email"],[69,66,81,51],[69,68,81,53,"password"],[69,76,81,61],[69,77,81,62],[70,6,82,4],[70,12,82,10],[71,8,82,12,"access_token"],[71,20,82,24],[72,8,82,26,"user"],[72,12,82,30],[72,14,82,32,"userData"],[73,6,82,41],[73,7,82,42],[73,10,82,45,"response"],[73,18,82,53],[74,6,84,4],[74,12,84,10,"AsyncStorage"],[74,24,84,22],[74,25,84,22,"default"],[74,32,84,22],[74,33,84,23,"setItem"],[74,40,84,30],[74,41,84,31],[74,53,84,43],[74,55,84,45,"access_token"],[74,67,84,57],[74,68,84,58],[75,6,85,4],[75,12,85,10,"AsyncStorage"],[75,24,85,22],[75,25,85,22,"default"],[75,32,85,22],[75,33,85,23,"setItem"],[75,40,85,30],[75,41,85,31],[75,52,85,42],[75,54,85,44,"JSON"],[75,58,85,48],[75,59,85,49,"stringify"],[75,68,85,58],[75,69,85,59,"userData"],[75,77,85,67],[75,78,85,68],[75,79,85,69],[76,6,87,4,"api"],[76,18,87,7],[76,19,87,7,"api"],[76,22,87,7],[76,23,87,8,"setToken"],[76,31,87,16],[76,32,87,17,"access_token"],[76,44,87,29],[76,45,87,30],[77,6,88,4,"setToken"],[77,14,88,12],[77,15,88,13,"access_token"],[77,27,88,25],[77,28,88,26],[78,6,89,4,"setUser"],[78,13,89,11],[78,14,89,12,"userData"],[78,22,89,20],[78,23,89,21],[79,4,90,2],[79,5,90,3],[80,4,92,2],[80,10,92,8,"logout"],[80,16,92,14],[80,19,92,17],[80,25,92,17,"logout"],[80,26,92,17],[80,31,92,29],[81,6,93,4],[81,12,93,10,"AsyncStorage"],[81,24,93,22],[81,25,93,22,"default"],[81,32,93,22],[81,33,93,23,"removeItem"],[81,43,93,33],[81,44,93,34],[81,56,93,46],[81,57,93,47],[82,6,94,4],[82,12,94,10,"AsyncStorage"],[82,24,94,22],[82,25,94,22,"default"],[82,32,94,22],[82,33,94,23,"removeItem"],[82,43,94,33],[82,44,94,34],[82,55,94,45],[82,56,94,46],[83,6,95,4,"api"],[83,18,95,7],[83,19,95,7,"api"],[83,22,95,7],[83,23,95,8,"setToken"],[83,31,95,16],[83,32,95,17],[83,36,95,21],[83,37,95,22],[84,6,96,4,"setToken"],[84,14,96,12],[84,15,96,13],[84,19,96,17],[84,20,96,18],[85,6,97,4,"setUser"],[85,13,97,11],[85,14,97,12],[85,18,97,16],[85,19,97,17],[86,4,98,2],[86,5,98,3],[87,4,100,2],[87,10,100,8,"refreshUser"],[87,21,100,19],[87,24,100,22],[87,30,100,22,"refreshUser"],[87,31,100,22],[87,36,100,34],[88,6,101,4],[88,10,101,8,"token"],[88,15,101,13],[88,17,101,15],[89,8,102,6],[89,12,102,10],[90,10,103,8],[90,16,103,14,"response"],[90,24,103,22],[90,27,103,25],[90,33,103,31,"api"],[90,45,103,34],[90,46,103,34,"api"],[90,49,103,34],[90,50,103,35,"getMe"],[90,55,103,40],[90,56,103,41],[90,57,103,42],[91,10,104,8,"setUser"],[91,17,104,15],[91,18,104,16,"response"],[91,26,104,24],[91,27,104,25],[92,10,105,8],[92,16,105,14,"AsyncStorage"],[92,28,105,26],[92,29,105,26,"default"],[92,36,105,26],[92,37,105,27,"setItem"],[92,44,105,34],[92,45,105,35],[92,56,105,46],[92,58,105,48,"JSON"],[92,62,105,52],[92,63,105,53,"stringify"],[92,72,105,62],[92,73,105,63,"response"],[92,81,105,71],[92,82,105,72],[92,83,105,73],[93,8,106,6],[93,9,106,7],[93,10,106,8],[93,17,106,15,"error"],[93,22,106,20],[93,24,106,22],[94,10,107,8,"console"],[94,17,107,15],[94,18,107,16,"error"],[94,23,107,21],[94,24,107,22],[94,48,107,46],[94,50,107,48,"error"],[94,55,107,53],[94,56,107,54],[95,8,108,6],[96,6,109,4],[97,4,110,2],[97,5,110,3],[98,4,112,2],[98,24,113,4],[98,28,113,4,"_reactJsxDevRuntime"],[98,47,113,4],[98,48,113,4,"jsxDEV"],[98,54,113,4],[98,56,113,5,"AuthContext"],[98,67,113,16],[98,68,113,17,"Provider"],[98,76,113,25],[99,6,113,26,"value"],[99,11,113,31],[99,13,113,33],[100,8,113,35,"user"],[100,12,113,39],[101,8,113,41,"token"],[101,13,113,46],[102,8,113,48,"isLoading"],[102,17,113,57],[103,8,113,59,"isAdmin"],[103,15,113,66],[104,8,113,68,"login"],[104,13,113,73],[105,8,113,75,"register"],[105,16,113,83],[106,8,113,85,"logout"],[106,14,113,91],[107,8,113,93,"refreshUser"],[108,6,113,105],[108,7,113,107],[109,6,113,107,"children"],[109,14,113,107],[109,16,114,7,"children"],[110,4,114,15],[111,6,114,15,"fileName"],[111,14,114,15],[111,16,114,15,"_jsxFileName"],[111,28,114,15],[112,6,114,15,"lineNumber"],[112,16,114,15],[113,6,114,15,"columnNumber"],[113,18,114,15],[114,4,114,15],[114,11,115,26],[114,12,115,27],[115,2,117,0],[116,2,119,7],[116,11,119,16,"useAuth"],[116,18,119,23,"useAuth"],[116,19,119,23],[116,21,119,26],[117,4,120,2],[117,10,120,8,"context"],[117,17,120,15],[117,20,120,18],[117,24,120,18,"useContext"],[117,30,120,28],[117,31,120,28,"useContext"],[117,41,120,28],[117,43,120,29,"AuthContext"],[117,54,120,40],[117,55,120,41],[118,4,121,2],[118,8,121,6,"context"],[118,15,121,13],[118,20,121,18,"undefined"],[118,29,121,27],[118,31,121,29],[119,6,122,4],[119,12,122,10],[119,16,122,14,"Error"],[119,21,122,19],[119,22,122,20],[119,67,122,65],[119,68,122,66],[120,4,123,2],[121,4,124,2],[121,11,124,9,"context"],[121,18,124,16],[122,2,125,0],[123,0,125,1],[123,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadStoredAuth","login","register","logout","refreshUser","useAuth"],"mappings":"AAA;OC6B;YCO;GDE;yBEE;GFyB;gBGE;GHU;mBIE;GJU;iBKE;GLM;sBME;GNU;CDO;OQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}