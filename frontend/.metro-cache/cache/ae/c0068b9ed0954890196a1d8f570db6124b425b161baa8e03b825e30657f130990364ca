{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":38,"index":198}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const isAdmin = user?.role === 'admin';\n    (0, _react.useEffect)(() => {\n      loadStoredAuth();\n    }, []);\n    const loadStoredAuth = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('auth_token');\n        const storedUser = await AsyncStorage.default.getItem('auth_user');\n        if (storedToken && storedUser) {\n          setToken(storedToken);\n          setUser(JSON.parse(storedUser));\n          _servicesApi.api.setToken(storedToken);\n\n          // Verify token is still valid\n          try {\n            const response = await _servicesApi.api.getMe();\n            setUser(response);\n            await AsyncStorage.default.setItem('auth_user', JSON.stringify(response));\n          } catch (error) {\n            // Token invalid, clear auth\n            await logout();\n          }\n        }\n      } catch (error) {\n        console.error('Error loading auth:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      const response = await _servicesApi.api.login(email, password);\n      const {\n        access_token,\n        user: userData\n      } = response;\n      await AsyncStorage.default.setItem('auth_token', access_token);\n      await AsyncStorage.default.setItem('auth_user', JSON.stringify(userData));\n      _servicesApi.api.setToken(access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const register = async (name, email, password) => {\n      const response = await _servicesApi.api.register(name, email, password);\n      const {\n        access_token,\n        user: userData\n      } = response;\n      await AsyncStorage.default.setItem('auth_token', access_token);\n      await AsyncStorage.default.setItem('auth_user', JSON.stringify(userData));\n      _servicesApi.api.setToken(access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('auth_token');\n      await AsyncStorage.default.removeItem('auth_user');\n      _servicesApi.api.setToken(null);\n      setToken(null);\n      setUser(null);\n    };\n    const refreshUser = async () => {\n      if (token) {\n        try {\n          const response = await _servicesApi.api.getMe();\n          setUser(response);\n          await AsyncStorage.default.setItem('auth_user', JSON.stringify(response));\n        } catch (error) {\n          console.error('Error refreshing user:', error);\n        }\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        token,\n        isLoading,\n        isAdmin,\n        login,\n        register,\n        logout,\n        refreshUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":123,"map":[[13,2,35,0,"exports"],[13,9,35,0],[13,10,35,0,"AuthProvider"],[13,22,35,0],[13,25,35,0,"AuthProvider"],[13,37,35,0],[14,2,124,0,"exports"],[14,9,124,0],[14,10,124,0,"useAuth"],[14,17,124,0],[14,20,124,0,"useAuth"],[14,27,124,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_servicesApi"],[18,18,3,0],[18,21,3,0,"require"],[18,28,3,0],[18,29,3,0,"_dependencyMap"],[18,43,3,0],[19,2,3,38],[19,6,3,38,"_reactJsxDevRuntime"],[19,25,3,38],[19,28,3,38,"require"],[19,35,3,38],[19,36,3,38,"_dependencyMap"],[19,50,3,38],[20,2,33,0],[20,8,33,6,"AuthContext"],[20,19,33,17],[20,35,33,20],[20,39,33,20,"createContext"],[20,45,33,33],[20,46,33,33,"createContext"],[20,59,33,33],[20,61,33,63,"undefined"],[20,70,33,72],[20,71,33,73],[21,2,35,7],[21,11,35,16,"AuthProvider"],[21,23,35,28,"AuthProvider"],[21,24,35,29],[22,4,35,31,"children"],[23,2,35,65],[23,3,35,66],[23,5,35,68],[24,4,36,2],[24,10,36,8],[24,11,36,9,"user"],[24,15,36,13],[24,17,36,15,"setUser"],[24,24,36,22],[24,25,36,23],[24,28,36,26],[24,32,36,26,"useState"],[24,38,36,34],[24,39,36,34,"useState"],[24,47,36,34],[24,49,36,48],[24,53,36,52],[24,54,36,53],[25,4,37,2],[25,10,37,8],[25,11,37,9,"token"],[25,16,37,14],[25,18,37,16,"setToken"],[25,26,37,24],[25,27,37,25],[25,30,37,28],[25,34,37,28,"useState"],[25,40,37,36],[25,41,37,36,"useState"],[25,49,37,36],[25,51,37,52],[25,55,37,56],[25,56,37,57],[26,4,38,2],[26,10,38,8],[26,11,38,9,"isLoading"],[26,20,38,18],[26,22,38,20,"setIsLoading"],[26,34,38,32],[26,35,38,33],[26,38,38,36],[26,42,38,36,"useState"],[26,48,38,44],[26,49,38,44,"useState"],[26,57,38,44],[26,59,38,45],[26,63,38,49],[26,64,38,50],[27,4,40,2],[27,10,40,8,"isAdmin"],[27,17,40,15],[27,20,40,18,"user"],[27,24,40,22],[27,26,40,24,"role"],[27,30,40,28],[27,35,40,33],[27,42,40,40],[28,4,42,2],[28,8,42,2,"useEffect"],[28,14,42,11],[28,15,42,11,"useEffect"],[28,24,42,11],[28,26,42,12],[28,32,42,18],[29,6,43,4,"loadStoredAuth"],[29,20,43,18],[29,21,43,19],[29,22,43,20],[30,4,44,2],[30,5,44,3],[30,7,44,5],[30,9,44,7],[30,10,44,8],[31,4,46,2],[31,10,46,8,"loadStoredAuth"],[31,24,46,22],[31,27,46,25],[31,33,46,25,"loadStoredAuth"],[31,34,46,25],[31,39,46,37],[32,6,47,4],[32,10,47,8],[33,8,48,6],[33,14,48,12,"storedToken"],[33,25,48,23],[33,28,48,26],[33,34,48,32,"AsyncStorage"],[33,46,48,44],[33,47,48,44,"default"],[33,54,48,44],[33,55,48,45,"getItem"],[33,62,48,52],[33,63,48,53],[33,75,48,65],[33,76,48,66],[34,8,49,6],[34,14,49,12,"storedUser"],[34,24,49,22],[34,27,49,25],[34,33,49,31,"AsyncStorage"],[34,45,49,43],[34,46,49,43,"default"],[34,53,49,43],[34,54,49,44,"getItem"],[34,61,49,51],[34,62,49,52],[34,73,49,63],[34,74,49,64],[35,8,51,6],[35,12,51,10,"storedToken"],[35,23,51,21],[35,27,51,25,"storedUser"],[35,37,51,35],[35,39,51,37],[36,10,52,8,"setToken"],[36,18,52,16],[36,19,52,17,"storedToken"],[36,30,52,28],[36,31,52,29],[37,10,53,8,"setUser"],[37,17,53,15],[37,18,53,16,"JSON"],[37,22,53,20],[37,23,53,21,"parse"],[37,28,53,26],[37,29,53,27,"storedUser"],[37,39,53,37],[37,40,53,38],[37,41,53,39],[38,10,54,8,"api"],[38,22,54,11],[38,23,54,11,"api"],[38,26,54,11],[38,27,54,12,"setToken"],[38,35,54,20],[38,36,54,21,"storedToken"],[38,47,54,32],[38,48,54,33],[40,10,56,8],[41,10,57,8],[41,14,57,12],[42,12,58,10],[42,18,58,16,"response"],[42,26,58,24],[42,29,58,27],[42,35,58,33,"api"],[42,47,58,36],[42,48,58,36,"api"],[42,51,58,36],[42,52,58,37,"getMe"],[42,57,58,42],[42,58,58,43],[42,59,58,44],[43,12,59,10,"setUser"],[43,19,59,17],[43,20,59,18,"response"],[43,28,59,26],[43,29,59,27],[44,12,60,10],[44,18,60,16,"AsyncStorage"],[44,30,60,28],[44,31,60,28,"default"],[44,38,60,28],[44,39,60,29,"setItem"],[44,46,60,36],[44,47,60,37],[44,58,60,48],[44,60,60,50,"JSON"],[44,64,60,54],[44,65,60,55,"stringify"],[44,74,60,64],[44,75,60,65,"response"],[44,83,60,73],[44,84,60,74],[44,85,60,75],[45,10,61,8],[45,11,61,9],[45,12,61,10],[45,19,61,17,"error"],[45,24,61,22],[45,26,61,24],[46,12,62,10],[47,12,63,10],[47,18,63,16,"logout"],[47,24,63,22],[47,25,63,23],[47,26,63,24],[48,10,64,8],[49,8,65,6],[50,6,66,4],[50,7,66,5],[50,8,66,6],[50,15,66,13,"error"],[50,20,66,18],[50,22,66,20],[51,8,67,6,"console"],[51,15,67,13],[51,16,67,14,"error"],[51,21,67,19],[51,22,67,20],[51,43,67,41],[51,45,67,43,"error"],[51,50,67,48],[51,51,67,49],[52,6,68,4],[52,7,68,5],[52,16,68,14],[53,8,69,6,"setIsLoading"],[53,20,69,18],[53,21,69,19],[53,26,69,24],[53,27,69,25],[54,6,70,4],[55,4,71,2],[55,5,71,3],[56,4,73,2],[56,10,73,8,"login"],[56,15,73,13],[56,18,73,16],[56,24,73,16,"login"],[56,25,73,23,"email"],[56,30,73,36],[56,32,73,38,"password"],[56,40,73,54],[56,45,73,59],[57,6,74,4],[57,12,74,10,"response"],[57,20,74,18],[57,23,74,21],[57,29,74,27,"api"],[57,41,74,30],[57,42,74,30,"api"],[57,45,74,30],[57,46,74,31,"login"],[57,51,74,36],[57,52,74,37,"email"],[57,57,74,42],[57,59,74,44,"password"],[57,67,74,52],[57,68,74,53],[58,6,75,4],[58,12,75,10],[59,8,75,12,"access_token"],[59,20,75,24],[60,8,75,26,"user"],[60,12,75,30],[60,14,75,32,"userData"],[61,6,75,41],[61,7,75,42],[61,10,75,45,"response"],[61,18,75,53],[62,6,77,4],[62,12,77,10,"AsyncStorage"],[62,24,77,22],[62,25,77,22,"default"],[62,32,77,22],[62,33,77,23,"setItem"],[62,40,77,30],[62,41,77,31],[62,53,77,43],[62,55,77,45,"access_token"],[62,67,77,57],[62,68,77,58],[63,6,78,4],[63,12,78,10,"AsyncStorage"],[63,24,78,22],[63,25,78,22,"default"],[63,32,78,22],[63,33,78,23,"setItem"],[63,40,78,30],[63,41,78,31],[63,52,78,42],[63,54,78,44,"JSON"],[63,58,78,48],[63,59,78,49,"stringify"],[63,68,78,58],[63,69,78,59,"userData"],[63,77,78,67],[63,78,78,68],[63,79,78,69],[64,6,80,4,"api"],[64,18,80,7],[64,19,80,7,"api"],[64,22,80,7],[64,23,80,8,"setToken"],[64,31,80,16],[64,32,80,17,"access_token"],[64,44,80,29],[64,45,80,30],[65,6,81,4,"setToken"],[65,14,81,12],[65,15,81,13,"access_token"],[65,27,81,25],[65,28,81,26],[66,6,82,4,"setUser"],[66,13,82,11],[66,14,82,12,"userData"],[66,22,82,20],[66,23,82,21],[67,4,83,2],[67,5,83,3],[68,4,85,2],[68,10,85,8,"register"],[68,18,85,16],[68,21,85,19],[68,27,85,19,"register"],[68,28,85,26,"name"],[68,32,85,38],[68,34,85,40,"email"],[68,39,85,53],[68,41,85,55,"password"],[68,49,85,71],[68,54,85,76],[69,6,86,4],[69,12,86,10,"response"],[69,20,86,18],[69,23,86,21],[69,29,86,27,"api"],[69,41,86,30],[69,42,86,30,"api"],[69,45,86,30],[69,46,86,31,"register"],[69,54,86,39],[69,55,86,40,"name"],[69,59,86,44],[69,61,86,46,"email"],[69,66,86,51],[69,68,86,53,"password"],[69,76,86,61],[69,77,86,62],[70,6,87,4],[70,12,87,10],[71,8,87,12,"access_token"],[71,20,87,24],[72,8,87,26,"user"],[72,12,87,30],[72,14,87,32,"userData"],[73,6,87,41],[73,7,87,42],[73,10,87,45,"response"],[73,18,87,53],[74,6,89,4],[74,12,89,10,"AsyncStorage"],[74,24,89,22],[74,25,89,22,"default"],[74,32,89,22],[74,33,89,23,"setItem"],[74,40,89,30],[74,41,89,31],[74,53,89,43],[74,55,89,45,"access_token"],[74,67,89,57],[74,68,89,58],[75,6,90,4],[75,12,90,10,"AsyncStorage"],[75,24,90,22],[75,25,90,22,"default"],[75,32,90,22],[75,33,90,23,"setItem"],[75,40,90,30],[75,41,90,31],[75,52,90,42],[75,54,90,44,"JSON"],[75,58,90,48],[75,59,90,49,"stringify"],[75,68,90,58],[75,69,90,59,"userData"],[75,77,90,67],[75,78,90,68],[75,79,90,69],[76,6,92,4,"api"],[76,18,92,7],[76,19,92,7,"api"],[76,22,92,7],[76,23,92,8,"setToken"],[76,31,92,16],[76,32,92,17,"access_token"],[76,44,92,29],[76,45,92,30],[77,6,93,4,"setToken"],[77,14,93,12],[77,15,93,13,"access_token"],[77,27,93,25],[77,28,93,26],[78,6,94,4,"setUser"],[78,13,94,11],[78,14,94,12,"userData"],[78,22,94,20],[78,23,94,21],[79,4,95,2],[79,5,95,3],[80,4,97,2],[80,10,97,8,"logout"],[80,16,97,14],[80,19,97,17],[80,25,97,17,"logout"],[80,26,97,17],[80,31,97,29],[81,6,98,4],[81,12,98,10,"AsyncStorage"],[81,24,98,22],[81,25,98,22,"default"],[81,32,98,22],[81,33,98,23,"removeItem"],[81,43,98,33],[81,44,98,34],[81,56,98,46],[81,57,98,47],[82,6,99,4],[82,12,99,10,"AsyncStorage"],[82,24,99,22],[82,25,99,22,"default"],[82,32,99,22],[82,33,99,23,"removeItem"],[82,43,99,33],[82,44,99,34],[82,55,99,45],[82,56,99,46],[83,6,100,4,"api"],[83,18,100,7],[83,19,100,7,"api"],[83,22,100,7],[83,23,100,8,"setToken"],[83,31,100,16],[83,32,100,17],[83,36,100,21],[83,37,100,22],[84,6,101,4,"setToken"],[84,14,101,12],[84,15,101,13],[84,19,101,17],[84,20,101,18],[85,6,102,4,"setUser"],[85,13,102,11],[85,14,102,12],[85,18,102,16],[85,19,102,17],[86,4,103,2],[86,5,103,3],[87,4,105,2],[87,10,105,8,"refreshUser"],[87,21,105,19],[87,24,105,22],[87,30,105,22,"refreshUser"],[87,31,105,22],[87,36,105,34],[88,6,106,4],[88,10,106,8,"token"],[88,15,106,13],[88,17,106,15],[89,8,107,6],[89,12,107,10],[90,10,108,8],[90,16,108,14,"response"],[90,24,108,22],[90,27,108,25],[90,33,108,31,"api"],[90,45,108,34],[90,46,108,34,"api"],[90,49,108,34],[90,50,108,35,"getMe"],[90,55,108,40],[90,56,108,41],[90,57,108,42],[91,10,109,8,"setUser"],[91,17,109,15],[91,18,109,16,"response"],[91,26,109,24],[91,27,109,25],[92,10,110,8],[92,16,110,14,"AsyncStorage"],[92,28,110,26],[92,29,110,26,"default"],[92,36,110,26],[92,37,110,27,"setItem"],[92,44,110,34],[92,45,110,35],[92,56,110,46],[92,58,110,48,"JSON"],[92,62,110,52],[92,63,110,53,"stringify"],[92,72,110,62],[92,73,110,63,"response"],[92,81,110,71],[92,82,110,72],[92,83,110,73],[93,8,111,6],[93,9,111,7],[93,10,111,8],[93,17,111,15,"error"],[93,22,111,20],[93,24,111,22],[94,10,112,8,"console"],[94,17,112,15],[94,18,112,16,"error"],[94,23,112,21],[94,24,112,22],[94,48,112,46],[94,50,112,48,"error"],[94,55,112,53],[94,56,112,54],[95,8,113,6],[96,6,114,4],[97,4,115,2],[97,5,115,3],[98,4,117,2],[98,24,118,4],[98,28,118,4,"_reactJsxDevRuntime"],[98,47,118,4],[98,48,118,4,"jsxDEV"],[98,54,118,4],[98,56,118,5,"AuthContext"],[98,67,118,16],[98,68,118,17,"Provider"],[98,76,118,25],[99,6,118,26,"value"],[99,11,118,31],[99,13,118,33],[100,8,118,35,"user"],[100,12,118,39],[101,8,118,41,"token"],[101,13,118,46],[102,8,118,48,"isLoading"],[102,17,118,57],[103,8,118,59,"isAdmin"],[103,15,118,66],[104,8,118,68,"login"],[104,13,118,73],[105,8,118,75,"register"],[105,16,118,83],[106,8,118,85,"logout"],[106,14,118,91],[107,8,118,93,"refreshUser"],[108,6,118,105],[108,7,118,107],[109,6,118,107,"children"],[109,14,118,107],[109,16,119,7,"children"],[110,4,119,15],[111,6,119,15,"fileName"],[111,14,119,15],[111,16,119,15,"_jsxFileName"],[111,28,119,15],[112,6,119,15,"lineNumber"],[112,16,119,15],[113,6,119,15,"columnNumber"],[113,18,119,15],[114,4,119,15],[114,11,120,26],[114,12,120,27],[115,2,122,0],[116,2,124,7],[116,11,124,16,"useAuth"],[116,18,124,23,"useAuth"],[116,19,124,23],[116,21,124,26],[117,4,125,2],[117,10,125,8,"context"],[117,17,125,15],[117,20,125,18],[117,24,125,18,"useContext"],[117,30,125,28],[117,31,125,28,"useContext"],[117,41,125,28],[117,43,125,29,"AuthContext"],[117,54,125,40],[117,55,125,41],[118,4,126,2],[118,8,126,6,"context"],[118,15,126,13],[118,20,126,18,"undefined"],[118,29,126,27],[118,31,126,29],[119,6,127,4],[119,12,127,10],[119,16,127,14,"Error"],[119,21,127,19],[119,22,127,20],[119,67,127,65],[119,68,127,66],[120,4,128,2],[121,4,129,2],[121,11,129,9,"context"],[121,18,129,16],[122,2,130,0],[123,0,130,1],[123,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadStoredAuth","login","register","logout","refreshUser","useAuth"],"mappings":"AAA;OCkC;YCO;GDE;yBEE;GFyB;gBGE;GHU;mBIE;GJU;iBKE;GLM;sBME;GNU;CDO;OQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}